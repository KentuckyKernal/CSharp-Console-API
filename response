using System;
using System.Net.Http;
using System.IO;
using Newtonsoft.Json;

namespace ConsoleApp2
{

    class Program
    {

        private static string _uri = "http://api.open-notify.org/astros.json";

        private static async void Client_Response()
        {
            // Create an HttpClient instance
            HttpClient client = new HttpClient();

            // Send a request asynchronously and continue when complete
            HttpResponseMessage resp = await client.GetAsync(_uri);

            // Check that response was successful or throw exception

            resp.EnsureSuccessStatusCode();

            // Read response asynchronously as stream            
            var ras = await resp.Content.ReadAsStreamAsync();
            
            //Serialize data to json format
            using (var streamReader = new StreamReader(ras))
            {
                //set response content to string value
                string sj = streamReader.ReadToEnd();

                //Convert data to Json
                var ds = JsonConvert.DeserializeObject(sj);

                Console.WriteLine(ds);

            }
        }

        static void Main(string[] args)
        {
            Client_Response();

            Console.ReadLine();
        }
    }
}
